---
category: [编程]
tags: [编程, C]
title: gcc & gdb
date: 2025-12-06 01:00:36
---

<style>
  table {
    width: 100%
    }
  td {
    vertical-align: center;
    text-align: center;
  }
  table.inputT{
    margin: 10px;
    width: auto;
    margin-left: auto;
    margin-right: auto;
    border: none;
  }
  input{
    text-align: center;
    padding: 0px 10px;
  }
  iframe{
    width: 100%;
    display: block;
    border-style:none;
  }
</style>

# GCC（GNU 编译器集合）

**GCC** 是由 **GNU** 项目开发的编译器集合。它支持多种编程语言，包括 C、C++、Objective-C、Fortran、Ada 和 Go。

它的主要功能是将这些语言编写的源代码翻译成可执行的机器代码或目标文件。编译 C++ 程序时，通常使用 g++ 而不是 gcc，因为 g++ 会自动处理必要的 C++ 标准库的链接。

**GCC** 提供丰富的编译选项和优化功能，能够生成高效可靠的代码。


一些常见的 GCC 命令行选项包括：

 - c：编译并汇编，但不链接
 - o <输出>：指定输出文件名
 - g：生成调试信息
 - Wall：启用所有警告信息
 - Werror：将所有警告视为错误
 - O<n>：优化级别，其中 n 为 0、1、2、3 或 s
 - fPIC：创建位置无关代码
 - l：加入程式库
 - fsanitize=address：是一个功能强大且速度极快的内存错误检测器，用于在运行时识别各种与内存相关的错误。如下：
    - 堆缓冲区溢出：如访问数组超出范围
    - 栈缓冲区溢出：栈上的变量被非法访问
    - 全局缓冲区溢出：访问了超出全局变量定义的范围
    - 使用已释放的内存：使用了已经通过 free 释放的指针
    - 双重释放：对同一块内存重复调用 free
    - 未初始化的堆内存使用


# GDB（GNU调试器）

**GDB** 是一款功能强大的源代码级调试器，由 **GNU** 项目开发。它用于分析和调试用 C、C++、Ada 等语言编写的程序。

**GDB** 允许开发人员在程序执行期间检查其内部运行情况，从而简化诸如逐行执行代码、设置断点、检查和修改变量值以及跟踪函数调用等任务。

为了使用 **GDB** 进行有效的调试，程序必须在编译时包含调试信息。这可以通过在 **GCC** 编译时使用 <font color="#FF1000">-g</font> 标志来实现（例如，gcc -g myprogram.c -o myprogram）。

**GDB** 提供命令行界面进行交互，其功能还可以与各种图形前端和集成开发环境（IDE）集成，例如 VS Code 或 Eclipse。

## 常用 GDB 命令

|命令| 缩写|说明|
|:---:|:---:|:---:|
|run|r|开始执行程式|
|break <n>|b <n>|在指定位置 n（行号或函数名）设定中断点|
|continue|c|从当前暂停处继续执行，直到下一个中​​断点或程式结束|
|next|n|执行下一行程式码，不进入函数内部|
|step|s|执行下一行程式码，并进入函数内部|
|print|p|显示变数的当前值|
|list|l|显示当前程式码周围的原始码|
|backtrace|bt|显示当前的函数呼叫堆叠|
|quit|q|结束 GDB 侦错会话|


## 文本用户界面 (TUI)

GDB 的文本用户界面 (TUI) 是一个基于终端的界面，它通过提供多个窗口来显示调试会话期间的相关信息，从而增强调试体验。它利用 curses 库在终端内创建了一个更直观、更具交互性的环境。

启用和控制 TUI：

 - 启用 TUI：可以使用 `gdbtui` 或 `gdb -tui` 命令启动 GDB 并启用 TUI。
 - 切换 TUI 模式：在 GDB 会话中，可以使用组合键 <font color="#FF1000">Ctrl+X+A</font> 或输入 `tui enable` 和 `tui disable` 来进入或退出 TUI 模式。
 - 布局：TUI 提供多种布局来排列可见窗口，例如“仅源代码”、“仅汇编代码”、“源代码和汇编代码”或“源代码和寄存器”。可以使用特定命令或快捷键切换这些布局。
 - 导航：使用方向键在活动窗口内滚动。其他快捷键可用于在窗口之间导航、调整窗口大小和刷新显示。
 - 单键模式：TUI 包含一个“单键模式”，该模式将常用的 GDB 命令绑定到单个按键上（如，c，n，b 等等）。可以使用 <font color="#FF1000">Ctrl+X+S</font> 进入或退出此模式。

### 应用例子

```sh
gdb -tui ./a.out    // 开启应用界面， 侦错 a.out 文件
b main              // 设置断点在 main 
r                   // 重新执行程序
b 行号               // 设置断点在指定行号 
c                   // 执行程序至断点
n                   // 逐行执行程序
s                   // 跳入子程序中
p                   // 列出变数内容
q                   // 结束侦错
```

详细可参考：[C 工具 (Linux)](https://hkdickyko.github.io/%E8%BD%AF%E4%BB%B6/ctools)