---
category: [MPU]
tags: [IoT, 编程, 数学]
title: Runge-Kutta 计算方法
date: 2025-11-23 12:00:00
---

<style>
  table {
    width: 100%
    }
  td.left {
    vertical-align: center;
    text-align: left;
    width: 30%;
  }
  td {
    vertical-align: center;
    text-align: center;
  }
  table.inputT{
    margin: 10px;
    width: auto;
    margin-left: auto;
    margin-right: auto;
    border: none;
  }
  tr:nth-child(even){
    background-color:#ffffe5;
  }
  input{
    text-align: center;
    padding: 0px 10px;
  }
  iframe{
    width: 100%;
    display: block;
    border-style:none;
  }
</style>


# 龙格库塔法（Runge-Kutta)


Runge-Kutta 方法（龙格-库塔法）是一种用于求解常微分方程数值解的迭代算法。 其核心原理是透过在一个时间步长内计算多次导数的近似值，并将这些值以加权平均的方式组合起来，以获得比欧拉法更精确的下一个点的解。 简单来说，就是通过多个中间步骤来逼近真实解的曲线。  

以下是经典四阶龙格-库塔方法 (RK4) 

对于一个给定的常微分方程初值问题：


$$
\frac {dy}{dx} = f(x,y)， y(x_0) = y_0
$$

RK4 方法的目標是從當前點 $(x_{n},y_{n})$ 計算下一個點 $(x_{n+1},y_{n+1})$ 的近似解，其中 $x_{n+1}=x_{n}+h$，而 $h$ 是步長。它使用四個不同的斜率 $k_{1},k_{2},k_{3},k_{4}$ 的加權平均值來估計該步的平均斜率。


$$
\begin{align*}
k_1 &= h f(x_n, y_n) \\
k_2 &= h f\left(x_n + \frac{h}{2}, y_n + \frac{k_1}{2}\right) \\
k_3 &= h f\left(x_n + \frac{h}{2}, y_n + \frac{k_2}{2}\right) \\
k_4 &= h f(x_n + h, y_n + k_3) \\
y_{n+1} &= y_n + \frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)
\end{align*}
$$


**代码详解** 

 - $k_1$：步长开始时的斜率估计值。
 - $k_2$：用 $k_1$ 估计的中点处的斜率估计值。
 - $k_3$：用 $k_2$ 更精确估计中点处的斜率估计值。
 - $k_4$:用 $k_3$ 估计的终点处的斜率估计值。  
 - $y_{n+1}$：使用这四个斜率的加权平均（权重分别为 1, 2, 2, 1，总和为 6）计算出的下一个 $y$ 值。  
