---
category: [ Android]
tags: [Android]
title: Android 命令行编程
date: 2023-10-14 1:00:00
---


# Android 命令行编程

## 安裝 termux

从 F-Droid 或 goole playstore 安装 termux。

## 更新 termux

```
apt update
apt upgrade
apt update
termux-setup-storage
```

## 安装 ubuntu 平台

```
apt install git wget proot
git clone https://github.com/MFDGaming/ubuntu-in-termux.git
cd ubuntu-in-termux
bash ubuntu.sh -y
sed -Ei 's|(:/bin)(:/usr/bin):|\2\1:|' startubuntu.sh
./startubuntu.sh
```

## 安装 Android SDK 构建工具

```
apt update
apt upgrade
apt install aapt

# 以下 jdk 版本可能需要更新
apt install openjdk-19-jre
apt install openjdk-19-jdk
```


## 下载 Android 命令行工具


从 [Android 网站](https://developer.android.com/studio) 下载适用于 Linux 的 Android 命令行工具


将**命令行工具**解压到硬盘，它将被移动到下面命令中的相关位置

## 安装命令行工具

```
cd ~
export ANDROID_HOME=$HOME/android/sdk

# 移动 cmdline-tools 目录中的文件到下面命令中的相关位置及设置链接
mkdir -p $ANDROID_HOME/cmdline-tools
mv cmdline-tools $ANDROID_HOME/cmdline-tools/latest
export PATH=$PATH:$ANDROID_HOME/cmdline-tools/latest/bin

# 修复相关的依赖关系
JAVA_OPTS=-Dos.arch=amd64 sdkmanager emulator

# 安装目标编译平台
sdkmanager 'platforms;android-26'
```


## 缩小文件 html、js、css

```
apt install nodejs npm
apt install curl

apt install tidy
npm install html-minifier -g
npm install uglify-js -g
npm install clean-css-cli -g

## --- 目錄及子目錄下的所有文件 ---

# 整洁的 html 网页
find -type f -name *.html -exec bash -c 'tidy -config htmlTidyCfg.txt -f err.txt -m "$0"; ls "$0"' {} \;

# 缩小 html 文件
find -type f -name *.html -exec bash -c 'html-minifier -o "$0" -c html-min.json "$0"; ls "$0"' {} \;

# 缩小 JavaScript 文件
find -type f -name *.js -exec bash -c 'uglifyjs "$0" -m -o "$0"; ls "$0"' {} \;

# 缩小 CSS 文件
find -type f -name *.css -exec bash -c 'cleancss -O2 -o "$0" "$0"; ls "$0"' {} \;


## --- 单文件 ---

html-minifier -o $0 -c html-min.json $0
tidy -config htmlTidyCfg.txt -f err.txt -m $0

# 缩小/恢复 JavaScript 文件
uglifyjs $0 -m -o $0
uglifyjs $0 -b -o $0

# 缩小/恢复 CSS 文件
cleancss -O2 -o "$0" "$0"
cleancss --format beautify -o $0 $0

```

注: $0 为文件名称，单文件要自设定，其它为find 输出的文件名称。

[html tidy 互联资料网链接](http://api.html-tidy.org/tidy/tidylib_api_5.2.0/quick_ref.html)

### Html Tidy 设定文件

```
# htmlTidyCfg.txt

indent: auto
indent-spaces: 2
wrap: 0
markup: yes
output-xml: no
input-xml: no
show-warnings: yes
numeric-entities: yes
quote-marks: yes
quote-nbsp: yes
quote-ampersand: no
break-before-br: no
uppercase-tags: no
uppercase-attributes: no
char-encoding: utf8
```

### Html-minifier 设定文件

```
# html-min.json

{
  "caseSensitive": false,
  "collapseBooleanAttributes": true,
  "collapseInlineTagWhitespace": false,
  "collapseWhitespace": true,
  "conservativeCollapse": false,
  "continueOnParseError": true,
  "customAttrCollapse": ".*",
  "decodeEntities": true,
  "html5": true,
  "ignoreCustomFragments": [
    "<#[\\s\\S]*?#>",
    "<%[\\s\\S]*?%>",
    "<\\?[\\s\\S]*?\\?>"
  ],
  "includeAutoGeneratedTags": false,
  "keepClosingSlash": false,
  "maxLineLength": 0,
  "minifyCSS": true,
  "minifyJS": true,
  "preserveLineBreaks": false,
  "preventAttributesEscaping": false,
  "processConditionalComments": true,
  "processScripts": [
    "text/html"
  ],
  "removeAttributeQuotes": true,
  "removeComments": true,
  "removeEmptyAttributes": true,
  "removeEmptyElements": true,
  "removeOptionalTags": true,
  "removeRedundantAttributes": true,
  "removeScriptTypeAttributes": true,
  "removeStyleLinkTypeAttributes": true,
  "removeTagWhitespace": true,
  "sortAttributes": true,
  "sortClassName": true,
  "trimCustomFragments": true,
  "useShortDoctype": true
}
```

## 最佳CSS

PurgeCSS 是一个可以自动删除未使用 CSS 內容的工具，可以大大减少网页文件的大小，提升网站的速度。


```
npm install -g purify-css

# 安裝及使用
npm install -g purify-css
purifycss init.css *.html -i -o init.css

# 列出已安裝的工具
npm -g list


```